*************************ТЕСТОВОЕ ЗАДАНИЕ**************
1.
Задача №1
Имеется база со следующими таблицами:
CREATE TABLE `users` (
	`id` 		INT(11) NOT NULL AUTO_INCREMENT,
	`name` 	VARCHAR(255) DEFAULT NULL,
	`gender`	INT(11) NOT NULL COMMENT '0 - не указан, 1 - мужчина, 2 - женщина.',
	`birth_date`	INT(11) NOT NULL COMMENT 'Дата в unixtime.',
	PRIMARY KEY (`id`)
);
CREATE TABLE `phone_numbers` (
	`id` 		INT(11) NOT NULL AUTO_INCREMENT,
	`user_id`	INT(11) NOT NULL,
	`phone`	VARCHAR(255) DEFAULT NULL,
	PRIMARY KEY (`id`)
);
Оптимизируйте структуру таблиц и напишите запрос, возвращающий имена и количества телефонных номеров девушек в возрасте от 18 до 22 лет

решение:

Во-первых, обязательно нужно нормальизовать таблицу
Имя не должно быть одной ячейкой. Нужно отдельно делать fname, lname, second_name
Во-вторых, дата не должна быть в юникстайм, это имеет смысл для хранения токенов, например, но не даты. дата пусть будет в формате даты.

вот таким запросом мы вытащим все количества номеров в данном диапазоне: 
select u.name, count(p.phone) as phone_count from user u join phone_numbers p on u.id=p.user_id where u.gender = 2 and year(u.birth_date) between year(now()) - 22 and year(now()) - 18 group by u.name;

2.
Задача №2
Напишите код в парадигме ООП, соответствующий следующей структуре.
Сущности: Пользователь, Статья.
Связи: Один пользователь может написать несколько статей. У каждой статьи может быть только один пользователь-автор.
Функциональность:
    • возможность для пользователя создать новую статью;
    • возможность получить автора статьи;
    • возможность получить все статьи конкретного пользователя;
    • возможность сменить автора статьи.
Если вы применили какие-либо паттерны при написании, укажите какие и с какой целью.
Код, реализующий конкретную функциональность, не требуется, только общая структура классов и методов. Код должен быть прокомментирован в стиле PHPDoc.

применены паттерны характерные для ORM доктрины:
Entity
Repository
Builder
etc.

вот раположение ключевых файлов:
src/Entity/Author.php
src/Entity/Article.php
src/Repository/AuthorRepository.php
src/Repository/ArticleRepository.php


3.
во-первых, нужно убрать главное подключение к базе через цикл. Подключение к базе должно быть выделенно и выполнятся один раз.
Внутри цикла подключение вызывает излишнюю трату ресурсов базы данных и снижение производительности. Такой доступ считается несанкционированным по практикам разработки. 

во-вторых, нужно защитится от SQL-инъекции вот в этом месте:
$sql = mysqli_query($db, "SELECT * FROM users WHERE id=$user_id");

в-третьих, нужно организовать проверки входных данных. Входные данные могут быть пустые или не те. Это все должно быть предусмотренно кодом.

в-четвертых, сам факт того, что пользователь может получить данные других пользователей, должен как-то отражаться в системе авторизации и аутентификации. Очевидно, что такой пользователь должен быть в статусе-роле ['ADMIN'] или что-то типа того. Любой пользователь не должен видеть данные других пользователей. Это нарушение конфиденциальности

я разрабатывал изначально в концепциях Симфони, поэтому и проще сделать тот же функционал через Доктрину. У нас ведь цель - получение по входным данным айди - юзеров.
вот ссылка на код:
src/Repository/UserRepository;

но если нужно сделать средствами PDO mysql
то вот примерный вариант:
src/Repository/PdoUsers.php


